## PWM: regulando el nivel de un salida

Hasta ahora hemos visto cómo podemos encender o apagar utilizando un formato digital: encendido o apagado, todo o nada.

Ahora vamos a ver una forma de controlar la salida más sofisticada que se llama **PWM** y que nos va a permitir conseguir que la iluminación del led, o de otros dispositivo, sea de una forma gradual, pudiendo "simular" que estamos encendiendo un poco nuestro LED o encendiéndolo un poco más.

![](./images/PWM.gif)

Decimos simular porque en realidad no es que estemos encendiendo el led a "medio gas", sino que regulamos la potencia que se trasmite. En ningún caso estamos utilizando voltaje diferente, siempre utilizamos voltaje digitales, todo ó nada, 3.3 voltios ó 5 voltios, lo que tenga nuestro placa. 

Lo que sí hacemos es que lo encendemos un poquito más tiempo o menos con una frecuencia bastante alta, del orden de los 500 o 1000 Hz por segundos. Si mucho de ese de ese tiempo está activa, el resultado será que se está iluminando mucho, si hacemos que esté muy poco tiempo encendido pues eso será el efecto de que está bajo.

Por esto decimos que esta forma es una Modulación Variable del Pulso o PWM con sus siglas en inglés.

Vamos a ver como usar este pulso que estamos estableciendo se hace más abierto o menos y de esa forma conseguimos que en nuestro se ilumine más o se ilumine menos.

Vamos a usar el pin

```python
import machine
import time
import Wemos

pwm = machine.mPWM(machine.Pin(Wemos.D4))

# Recordamos que el D4 esta invertido
pwm.duty(0) # encendido a tope de brillo
time.sleep(1)
pwm.duty(512) # brillo al 50%
time.sleep(1)
pwm.duty(1022) # minimo valor iluminado
time.sleep(1)
pwm.duty(1023) # apagado

```

Podemos modificar la frecuencia de PWM usando pwm.freq(frecuencia), pudiendo estar entre 1Hz y 1kHz

Como ejemplo curioso si usamos la frecuencia de 1Hz (o valores por debajo de los 25 Hz) veremos parpadear el led

```python
pwm.freq(24)
pwm.duty(512) # 50%
```

[librería pwm](https://www.esploradores.com/micropython_pwm/)

## Jugando con la frecuencia de refresco

```python
pwm = machine.PWM(machine.Pin(2), freq = 50)  # estandard
pwm.duty(20) # 20%
pwm = machine.PWM(machine.Pin(2), freq = 1) # Frecuencia 1Hz
pwm = machine.PWM(machine.Pin(2), freq = 10) # frecuencia 10Hz
```

